#!/usr/bin/env ruby
require 'led_panel'
require 'bunny'

module LEDPanel
  class Client

    def initialize
      @connection = Connection.new
    end

    def run
      @connection.queue do |channel, queue|
        puts("Client started. Listening on queue “#{queue.name}”.")
        begin
          queue.subscribe(block: true) do |delivery_info, properties, body|
            puts(body)
          end
        rescue Interrupt
          return
        end
      end
    end
  end
end

client = LEDPanel::Client.new
client.run
